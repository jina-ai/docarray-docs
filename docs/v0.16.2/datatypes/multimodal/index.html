<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta property="og:title" content=" Multi-modal" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docarray.jina.ai/datatypes/multimodal/" />
<meta property="og:site_name" content="DocArray 0.16.2 Documentation" />
<meta property="og:description" content="Multi-modal: This example will walk you through how to use DocArray to process multiple data modalities, jointly. To do this comfortably and cleanly, you will use DocArray’s dataclass feature. Model your data: If you work with multiple modalities at the same time, most likely they stand in some r..." />
<meta property="og:image" content="https://docarray.jina.ai/_static/banner.png" />
<meta property="og:image:alt" content="DocArray 0.16.2 Documentation" />
<meta name="description" content="Multi-modal: This example will walk you through how to use DocArray to process multiple data modalities, jointly. To do this comfortably and cleanly, you will use DocArray’s dataclass feature. Model your data: If you work with multiple modalities at the same time, most likely they stand in some r..." />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@JinaAI_">
<meta name="twitter:creator" content="@JinaAI_">
<meta name="description" content="DocArray is a library for nested, unstructured data such as text, image, audio, video, 3D mesh.">
<meta property="og:description" content="DocArray is a library for nested, unstructured data such as text, image, audio, video, 3D mesh. It allows deep learning engineers to easily preprocess, embed, search, recommend and transfer the data.">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-48WE9V68SD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-48WE9V68SD');
</script>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    
<link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" /><link rel="next" title="Document" href="../../fundamentals/document/" /><link rel="prev" title="Table" href="../tabular/" />
        <link rel="canonical" href="https://docarray.jina.ai/datatypes/multimodal/index.html" />

    <link rel="shortcut icon" href="../../_static/favicon.png"/><!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Multi-modal - DocArray 0.16.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: #4d4d4d;
  --color-brand-primary: #009191;
  --color-brand-content: #009191;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
    <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
    <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
    <header class="mobile-header">
        <div class="header-left">
            <label class="nav-overlay-icon" for="__navigation">
                <div class="visually-hidden">Toggle site navigation sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-menu"></use>
                    </svg>
                </i>
            </label>
        </div>
        <div class="header-center">
            <a href="../../">
                <div class="brand">DocArray 0.16.2 documentation</div>
            </a>
        </div>
        <div class="header-right">
            <div class="theme-toggle-container theme-toggle-header">
                <button class="theme-toggle">
                    <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                    <svg class="theme-icon-when-auto">
                        <use href="#svg-sun-half"></use>
                    </svg>
                    <svg class="theme-icon-when-dark">
                        <use href="#svg-moon"></use>
                    </svg>
                    <svg class="theme-icon-when-light">
                        <use href="#svg-sun"></use>
                    </svg>
                </button>
            </div>
            <label class="toc-overlay-icon toc-header-icon" for="__toc">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-toc"></use>
                    </svg>
                </i>
            </label>
        </div>
    </header>
    <aside class="sidebar-drawer">
        <div class="sidebar-container">
            
            <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/logo-light.svg" alt="Light Logo" />
    <img class="sidebar-logo only-dark" src="../../_static/logo-dark.svg" alt="Dark Logo" />
  </div>
  
  
</a>
<script>
  function setPrefix(prefix){
    window.location.href = prefix
  }
</script>
<script defer>
  fetch(`https://${window.location.host}/_versions.json`)
  .then((resp) => resp.json())
  .then((data) => {
    var versionSelector = document.getElementsByClassName("version-select")[0];
    var currentPrefix = window.location.href.toString().split(window.location.host)[1].split('/')[1];

    for(var i = 0; i < data.length; i++){
      var option = document.createElement("option");
      option.innerHTML = data[i].version;
      option.value = "/" + data[i].version;
      versionSelector.appendChild(option);
      if(currentPrefix === data[i].version){
        versionSelector.selectedIndex = i + 1;
      }
    }
  })
  .catch((err) => console.log(err));
</script>
<div class="sd-d-flex-row sd-align-major-spaced">
  <a class="github-button" href="https://github.com/jina-ai/docarray" data-icon="octicon-star" data-show-count="true" aria-label="Star jina-ai/jina on GitHub" style="opacity: 0;">Star</a>
  <select onChange="setPrefix(this.value)" class="version-select">
    <option value="/">latest</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
    <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/what-is/">What is DocArray?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/what-is/#comparing-to-alternatives">Comparing to Alternatives</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../get-started/install/">Install</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Multimodal Data</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../text/"><svg aria-hidden="true" class="sd-octicon sd-octicon-typography" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M6.21 8.5L4.574 3.594 2.857 8.5H6.21zm.5 1.5l.829 2.487a.75.75 0 001.423-.474L5.735 2.332a1.216 1.216 0 00-2.302-.018l-3.39 9.688a.75.75 0 001.415.496L2.332 10H6.71zm3.13-4.358C10.53 4.374 11.87 4 13 4c1.5 0 3 .939 3 2.601v5.649a.75.75 0 01-1.448.275C13.995 12.82 13.3 13 12.5 13c-.77 0-1.514-.231-2.078-.709-.577-.488-.922-1.199-.922-2.041 0-.694.265-1.411.887-1.944C11 7.78 11.88 7.5 13 7.5h1.5v-.899c0-.54-.5-1.101-1.5-1.101-.869 0-1.528.282-1.84.858a.75.75 0 11-1.32-.716zM14.5 9H13c-.881 0-1.375.22-1.637.444-.253.217-.363.5-.363.806 0 .408.155.697.39.896.249.21.63.354 1.11.354.732 0 1.26-.209 1.588-.449.35-.257.412-.495.412-.551V9z" fill-rule="evenodd"></path></svg> Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../image/"><svg aria-hidden="true" class="sd-octicon sd-octicon-image" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M1.75 2.5a.25.25 0 00-.25.25v10.5c0 .138.112.25.25.25h.94a.76.76 0 01.03-.03l6.077-6.078a1.75 1.75 0 012.412-.06L14.5 10.31V2.75a.25.25 0 00-.25-.25H1.75zm12.5 11H4.81l5.048-5.047a.25.25 0 01.344-.009l4.298 3.889v.917a.25.25 0 01-.25.25zm1.75-.25V2.75A1.75 1.75 0 0014.25 1H1.75A1.75 1.75 0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0016 13.25zM5.5 6a.5.5 0 11-1 0 .5.5 0 011 0zM7 6a2 2 0 11-4 0 2 2 0 014 0z" fill-rule="evenodd"></path></svg> Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../video/"><svg aria-hidden="true" class="sd-octicon sd-octicon-device-camera-video" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M16 3.75a.75.75 0 00-1.136-.643L11 5.425V4.75A1.75 1.75 0 009.25 3h-7.5A1.75 1.75 0 000 4.75v6.5C0 12.216.784 13 1.75 13h7.5A1.75 1.75 0 0011 11.25v-.675l3.864 2.318A.75.75 0 0016 12.25v-8.5zm-5 5.075l3.5 2.1v-5.85l-3.5 2.1v1.65zM9.5 6.75v-2a.25.25 0 00-.25-.25h-7.5a.25.25 0 00-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-4.5z" fill-rule="evenodd"></path></svg> Video</a></li>
<li class="toctree-l2"><a class="reference internal" href="../audio/"><svg aria-hidden="true" class="sd-octicon sd-octicon-unmute" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.563 2.069A.75.75 0 018 2.75v10.5a.75.75 0 01-1.238.57L3.472 11H1.75A1.75 1.75 0 010 9.25v-2.5C0 5.784.784 5 1.75 5h1.723l3.289-2.82a.75.75 0 01.801-.111zM6.5 4.38L4.238 6.319a.75.75 0 01-.488.181h-2a.25.25 0 00-.25.25v2.5c0 .138.112.25.25.25h2a.75.75 0 01.488.18L6.5 11.62V4.38zm6.096-2.038a.75.75 0 011.06 0 8 8 0 010 11.314.75.75 0 01-1.06-1.06 6.5 6.5 0 000-9.193.75.75 0 010-1.06v-.001zm-1.06 2.121a.75.75 0 10-1.061 1.061 3.5 3.5 0 010 4.95.75.75 0 101.06 1.06 5 5 0 000-7.07l.001-.001z" fill-rule="evenodd"></path></svg> Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mesh/"><svg aria-hidden="true" class="sd-octicon sd-octicon-package" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M8.878.392a1.75 1.75 0 00-1.756 0l-5.25 3.045A1.75 1.75 0 001 4.951v6.098c0 .624.332 1.2.872 1.514l5.25 3.045a1.75 1.75 0 001.756 0l5.25-3.045c.54-.313.872-.89.872-1.514V4.951c0-.624-.332-1.2-.872-1.514L8.878.392zM7.875 1.69a.25.25 0 01.25 0l4.63 2.685L8 7.133 3.245 4.375l4.63-2.685zM2.5 5.677v5.372c0 .09.047.171.125.216l4.625 2.683V8.432L2.5 5.677zm6.25 8.271l4.625-2.683a.25.25 0 00.125-.216V5.677L8.75 8.432v5.516z" fill-rule="evenodd"></path></svg> 3D Mesh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tabular/"><svg aria-hidden="true" class="sd-octicon sd-octicon-table" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v3.585a.746.746 0 010 .83v8.085A1.75 1.75 0 0114.25 16H6.309a.748.748 0 01-1.118 0H1.75A1.75 1.75 0 010 14.25V6.165a.746.746 0 010-.83V1.75zM1.5 6.5v7.75c0 .138.112.25.25.25H5v-8H1.5zM5 5H1.5V1.75a.25.25 0 01.25-.25H5V5zm1.5 1.5v8h7.75a.25.25 0 00.25-.25V6.5h-8zm8-1.5h-8V1.5h7.75a.25.25 0 01.25.25V5z" fill-rule="evenodd"></path></svg> Table</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#"><svg aria-hidden="true" class="sd-octicon sd-octicon-stack" height="1.0em" version="1.1" viewbox="0 0 16 16" width="1.0em"><path d="M7.122.392a1.75 1.75 0 011.756 0l5.003 2.902c.83.481.83 1.68 0 2.162L8.878 8.358a1.75 1.75 0 01-1.756 0L2.119 5.456a1.25 1.25 0 010-2.162L7.122.392zM8.125 1.69a.25.25 0 00-.25 0l-4.63 2.685 4.63 2.685a.25.25 0 00.25 0l4.63-2.685-4.63-2.685zM1.601 7.789a.75.75 0 011.025-.273l5.249 3.044a.25.25 0 00.25 0l5.249-3.044a.75.75 0 01.752 1.298l-5.248 3.044a1.75 1.75 0 01-1.756 0L1.874 8.814A.75.75 0 011.6 7.789zm0 3.5a.75.75 0 011.025-.273l5.249 3.044a.25.25 0 00.25 0l5.249-3.044a.75.75 0 01.752 1.298l-5.248 3.044a1.75 1.75 0 01-1.756 0l-5.248-3.044a.75.75 0 01-.273-1.025z" fill-rule="evenodd"></path></svg> Multi-modal</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fundamentals/document/">Document</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/document/construct/">Construct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/document/serialization/">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/document/attribute/">Access Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/document/embedding/">Embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/document/nested/">Nested Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/document/visualization/">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/document/fluent-interface/">Fluent Interface</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fundamentals/documentarray/">DocumentArray</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/construct/">Construct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/serialization/">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/access-elements/">Access Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/access-attributes/">Access Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/find/">Query by Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/parallelization/">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/visualization/">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/post-external/">Process via External Flow or Executor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/embedding/">Embed via Neural Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/matching/">Find Nearest Neighbours</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/subindex/">Search over Nested Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/documentarray/evaluation/">Evaluate Matches</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../fundamentals/dataclass/">Dataclass</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/dataclass/construct/">Construct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/dataclass/access/">Access Modality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/dataclass/new-type/">Support New Modality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../fundamentals/dataclass/example/">Process Modality</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../advanced/document-store/">Document Store</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/sqlite/">SQLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/annlite/">Annlite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/qdrant/">Qdrant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/elasticsearch/">Elasticsearch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/weaviate/">Weaviate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/redis/">Redis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/extend/">Add New Document Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/document-store/benchmark/">One Million Scale Benchmark</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Integrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentals/jina-support/">Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentals/notebook-support/">Jupyter Notebook/Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/torch-support/">PyTorch/Deep Learning Frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentals/fastapi-support/">FastAPI/Pydantic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced/graphql-support/">GraphQL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/"><span class="fab fa-python"></span> Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../proto/">Protocol Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/">Changelog</a></li>
</ul>

    <p class="caption" role="heading"><span class="caption-text">Ecosystem</span></p>
    <ul>
        <li class="toctree-l1">
            <a class="reference external" href="https://docs.jina.ai">
                <img class="sidebar-ecosys-logo only-light-line" src="../../_static/search-light.svg">
                <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/search-dark.svg">
                Jina</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://hub.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/hub-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/hub-dark.svg">
            Jina Hub</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://finetuner.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/finetuner-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/finetuner-dark.svg">
            Finetuner</a></li>
        <li class="toctree-l1"><a class="reference internal" href="#">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/docarray-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/docarray-dark.svg">
            DocArray</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://clip-as-service.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/cas-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/cas-dark.svg">
            CLIP-as-service</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://github.com/jina-ai/jcloud">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/JCloud-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/JCloud-dark.svg">
            JCloud</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://github.com/jina-ai/now">
            <img class="sidebar-ecosys-logo only-light-line" src="../../_static/now-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../_static/now-dark.svg">
            NOW</a></li>
    </ul>
</div>
</div>

            </div>
            
        </div>
    </aside>
    <div class="main">
        <div class="content">
            <div class="article-container">
                <a href="#" class="back-to-top muted-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
                    </svg>
                    <span>Back to top</span>
                </a>
                <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
                        <button class="theme-toggle">
                            <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                            <svg class="theme-icon-when-auto">
                                <use href="#svg-sun-half"></use>
                            </svg>
                            <svg class="theme-icon-when-dark">
                                <use href="#svg-moon"></use>
                            </svg>
                            <svg class="theme-icon-when-light">
                                <use href="#svg-sun"></use>
                            </svg>
                        </button>
                    </div>
                    <label class="toc-overlay-icon toc-content-icon"
                           for="__toc">
                        <div class="visually-hidden">Toggle table of contents sidebar</div>
                        <i class="icon">
                            <svg>
                                <use href="#svg-toc"></use>
                            </svg>
                        </i>
                    </label>
                </div>
                <article role="main">
                    <section id="svg-version-1-1-width-1-0em-height-1-0em-class-sd-octicon-sd-octicon-stack-viewbox-0-0-16-16-aria-hidden-true-path-fill-rule-evenodd-d-m7-122-392a1-75-1-75-0-011-756-0l5-003-2-902c-83-481-83-1-68-0-2-162l8-878-8-358a1-75-1-75-0-01-1-756-0l2-119-5-456a1-25-1-25-0-010-2-162l7-122-392zm8-125-1-69a-25-25-0-00-25-0l-4-63-2-685-4-63-2-685a-25-25-0-00-25-0l4-63-2-685-4-63-2-685zm1-601-7-789a-75-75-0-011-025-273l5-249-3-044a-25-25-0-00-25-0l5-249-3-044a-75-75-0-01-752-1-298l-5-248-3-044a1-75-1-75-0-01-1-756-0l1-874-8-814a-75-75-0-011-6-7-789zm0-3-5a-75-75-0-011-025-273l5-249-3-044a-25-25-0-00-25-0l5-249-3-044a-75-75-0-01-752-1-298l-5-248-3-044a1-75-1-75-0-01-1-756-0l-5-248-3-044a-75-75-0-01-273-1-025z-path-svg-multi-modal">
<span id="multimodal-example"></span><h1><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-stack" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M7.122.392a1.75 1.75 0 011.756 0l5.003 2.902c.83.481.83 1.68 0 2.162L8.878 8.358a1.75 1.75 0 01-1.756 0L2.119 5.456a1.25 1.25 0 010-2.162L7.122.392zM8.125 1.69a.25.25 0 00-.25 0l-4.63 2.685 4.63 2.685a.25.25 0 00.25 0l4.63-2.685-4.63-2.685zM1.601 7.789a.75.75 0 011.025-.273l5.249 3.044a.25.25 0 00.25 0l5.249-3.044a.75.75 0 01.752 1.298l-5.248 3.044a1.75 1.75 0 01-1.756 0L1.874 8.814A.75.75 0 011.6 7.789zm0 3.5a.75.75 0 011.025-.273l5.249 3.044a.25.25 0 00.25 0l5.249-3.044a.75.75 0 01.752 1.298l-5.248 3.044a1.75 1.75 0 01-1.756 0l-5.248-3.044a.75.75 0 01-.273-1.025z"></path></svg> Multi-modal<a class="headerlink" href="#svg-version-1-1-width-1-0em-height-1-0em-class-sd-octicon-sd-octicon-stack-viewbox-0-0-16-16-aria-hidden-true-path-fill-rule-evenodd-d-m7-122-392a1-75-1-75-0-011-756-0l5-003-2-902c-83-481-83-1-68-0-2-162l8-878-8-358a1-75-1-75-0-01-1-756-0l2-119-5-456a1-25-1-25-0-010-2-162l7-122-392zm8-125-1-69a-25-25-0-00-25-0l-4-63-2-685-4-63-2-685a-25-25-0-00-25-0l4-63-2-685-4-63-2-685zm1-601-7-789a-75-75-0-011-025-273l5-249-3-044a-25-25-0-00-25-0l5-249-3-044a-75-75-0-01-752-1-298l-5-248-3-044a1-75-1-75-0-01-1-756-0l1-874-8-814a-75-75-0-011-6-7-789zm0-3-5a-75-75-0-011-025-273l5-249-3-044a-25-25-0-00-25-0l5-249-3-044a-75-75-0-01-752-1-298l-5-248-3-044a1-75-1-75-0-01-1-756-0l-5-248-3-044a-75-75-0-01-273-1-025z-path-svg-multi-modal" title="Permalink to this heading">#</a></h1>
<p>This example will walk you through how to use DocArray to process multiple data modalities, jointly.
To do this comfortably and cleanly, you will use DocArray’s <a class="reference internal" href="../../fundamentals/dataclass/#dataclass"><span class="std std-ref">dataclass</span></a> feature.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>This example works with image and text data.
If you are not yet familiar with how to process these modalities individually, you may want to check out the
respective examples first: <a class="reference internal" href="../image/#image-type"><span class="std std-ref">Image</span></a> and <a class="reference internal" href="../text/#text-type"><span class="std std-ref">Text</span></a></p>
</div>
<section id="model-your-data">
<h2>Model your data<a class="headerlink" href="#model-your-data" title="Permalink to this heading">#</a></h2>
<p>If you work with multiple modalities at the same time, most likely they stand in some relation with each other.
DocArray’s dataclass feature allows you to model your data and these relationships, using the language of your domain.</p>
<p>Suppose you want to model a page of a newspaper that contains a main text, an image, and an image description.
You can model this example in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">docarray.typing</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">Text</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Page</span><span class="p">:</span>
    <span class="n">main_text</span><span class="p">:</span> <span class="n">Text</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">Image</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Text</span>
</pre></div>
</div>
<section id="instantiate-a-document">
<h3>Instantiate a Document<a class="headerlink" href="#instantiate-a-document" title="Permalink to this heading">#</a></h3>
<p>After defining the data model through dataclasses, you can instantiate the dataclasses with your actual data, and cast it to a <a class="reference internal" href="../../api/docarray.document/#docarray.document.Document" title="docarray.document.Document"><code class="xref py py-class docutils literal notranslate"><span class="pre">Document</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="n">page</span> <span class="o">=</span> <span class="n">Page</span><span class="p">(</span>
    <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;Hello world&#39;</span><span class="p">,</span>
    <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;This is the image of an apple&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, you can see the nested Document structure that was created automatically:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Output<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>📄 Document: 7f03e397da8725aa8a2aed4a0d64f263
└── 💠 Chunks
    ├── 📄 Document: 627c3b052b86e908b10475a4649ce49b
    │   ╭──────────────────────┬────────────────────────────────────────────────
    │   │ Attribute            │ Value                                          
    │   ├──────────────────────┼────────────────────────────────────────────────
    │   │ parent_id            │ 7f03e397da8725aa8a2aed4a0d64f263               
    │   │ granularity          │ 1                                              
    │   │ text                 │ Hello world                                    
    │   │ modality             │ text                                           
    │   ╰──────────────────────┴────────────────────────────────────────────────
    ├── 📄 Document: 79e75c074aa444341baac18549930450
    │   ╭──────────────┬────────────────────────────────────────────────────────
    │   │ Attribute    │ Value                                                  
    │   ├──────────────┼────────────────────────────────────────────────────────
    │   │ parent_id    │ 7f03e397da8725aa8a2aed4a0d64f263                       
    │   │ granularity  │ 1                                                      
    │   │ tensor       │ &lt;class &#39;numpy.ndarray&#39;&gt; in shape (618, 641, 3), dtype: 
    │   │ mime_type    │ image/png                                              
    │   │ uri          │ apple.png                                              
    │   │ modality     │ image                                                  
    │   ╰──────────────┴────────────────────────────────────────────────────────
    └── 📄 Document: 6861a1e3d77c3560a630dee34ba5ac7f
        ╭──────────────────────┬────────────────────────────────────────────────
        │ Attribute            │ Value                                          
        ├──────────────────────┼────────────────────────────────────────────────
        │ parent_id            │ 7f03e397da8725aa8a2aed4a0d64f263               
        │ granularity          │ 1                                              
        │ text                 │ This is the image of an apple                  
        │ modality             │ text                                           
        ╰──────────────────────┴────────────────────────────────────────────────
</pre></div>
</div>
</div>
</details></section>
<section id="nested-dataclasses-and-list-types">
<h3>Nested dataclasses and list types<a class="headerlink" href="#nested-dataclasses-and-list-types" title="Permalink to this heading">#</a></h3>
<p>If your domain requires a more complex model, you can use advanced features to represent that accurately.</p>
<p>For this example, we look at a journal which consists of a cover page and multiple other pages, as well as some metadata.
Further, each page contains a main text, and can contain and image and an image description.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">docarray.typing</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">JSON</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Page</span><span class="p">:</span>
    <span class="n">main_text</span><span class="p">:</span> <span class="n">Text</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">Image</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Text</span> <span class="o">=</span> <span class="kc">None</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Journal</span><span class="p">:</span>
    <span class="n">cover</span><span class="p">:</span> <span class="n">Page</span>
    <span class="n">pages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Page</span><span class="p">]</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">JSON</span>
</pre></div>
</div>
<p>You can instantiate this complex Document in the same way as before:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="n">pages</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Page</span><span class="p">(</span>
        <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;Hello world&#39;</span><span class="p">,</span>
        <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s1">&#39;This is the image of an apple&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">Page</span><span class="p">(</span><span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;Second page&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">journal</span> <span class="o">=</span> <span class="n">Journal</span><span class="p">(</span>
    <span class="n">cover</span><span class="o">=</span><span class="n">Page</span><span class="p">(</span><span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;DocArray Daily&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">),</span>
    <span class="n">pages</span><span class="o">=</span><span class="n">pages</span><span class="p">,</span>
    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;Jina AI&#39;</span><span class="p">,</span> <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">journal</span><span class="p">)</span>
<span class="n">doc</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Output<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>📄 Document: cab4e047bc84ffb6b8b0597ff4ee0e9f
└── 💠 Chunks
    ├── 📄 Document: ea686d21029e4687df83a6ee31af98b2
    │   ╭──────────────────────┬────────────────────────────────────────────────
    │   │ Attribute            │ Value                                          
    │   ├──────────────────────┼────────────────────────────────────────────────
    │   │ parent_id            │ cab4e047bc84ffb6b8b0597ff4ee0e9f               
    │   │ granularity          │ 1                                              
    │   ╰──────────────────────┴────────────────────────────────────────────────
    │   └── 💠 Chunks
    │       ├── 📄 Document: 139a5f16ab176b5c9d5088b1f2792973
    │       │   ╭──────────────────────┬────────────────────────────────────────
    │       │   │ Attribute            │ Value                                  
    │       │   ├──────────────────────┼────────────────────────────────────────
    │       │   │ parent_id            │ ea686d21029e4687df83a6ee31af98b2       
    │       │   │ granularity          │ 1                                      
    │       │   │ text                 │ DocArray Daily                         
    │       │   │ modality             │ text                                   
    │       │   ╰──────────────────────┴────────────────────────────────────────
    │       └── 📄 Document: f1e7527757c7dc6006fa8fa36e7b788f
    │           ╭──────────────┬────────────────────────────────────────────────
    │           │ Attribute    │ Value                                          
    │           ├──────────────┼────────────────────────────────────────────────
    │           │ parent_id    │ ea686d21029e4687df83a6ee31af98b2               
    │           │ granularity  │ 1                                              
    │           │ tensor       │ &lt;class &#39;numpy.ndarray&#39;&gt; in shape (618, 641, 3),
    │           │ mime_type    │ image/png                                      
    │           │ uri          │ apple.png                                      
    │           │ modality     │ image                                          
    │           ╰──────────────┴────────────────────────────────────────────────
    ├── 📄 Document: 2a13aee3a2ac8eadc07f43bc2dd83583
    │   ╭──────────────────────┬────────────────────────────────────────────────
    │   │ Attribute            │ Value                                          
    │   ├──────────────────────┼────────────────────────────────────────────────
    │   │ parent_id            │ cab4e047bc84ffb6b8b0597ff4ee0e9f               
    │   │ granularity          │ 1                                              
    │   ╰──────────────────────┴────────────────────────────────────────────────
    │   └── 💠 Chunks
    │       ├── 📄 Document: b6bcfa7000a25bd84ddcd35813c99b4c
    │       │   ╭──────────────────────┬────────────────────────────────────────
    │       │   │ Attribute            │ Value                                  
    │       │   ├──────────────────────┼────────────────────────────────────────
    │       │   │ parent_id            │ 2a13aee3a2ac8eadc07f43bc2dd83583       
    │       │   │ granularity          │ 1                                      
    │       │   ╰──────────────────────┴────────────────────────────────────────
    │       │   └── 💠 Chunks
    │       │       ├── 📄 Document: 71018fd73c13187309590e82b5255416
    │       │       │   ╭──────────────────────┬────────────────────────────────
    │       │       │   │ Attribute            │ Value                          
    │       │       │   ├──────────────────────┼────────────────────────────────
    │       │       │   │ parent_id            │ b6bcfa7000a25bd84ddcd35813c99b4
    │       │       │   │ granularity          │ 1                              
    │       │       │   │ text                 │ Hello world                    
    │       │       │   │ modality             │ text                           
    │       │       │   ╰──────────────────────┴────────────────────────────────
    │       │       ├── 📄 Document: b335f748006204dd27bb5fa9a99a572f
    │       │       │   ╭──────────────┬────────────────────────────────────────
    │       │       │   │ Attribute    │ Value                                  
    │       │       │   ├──────────────┼────────────────────────────────────────
    │       │       │   │ parent_id    │ b6bcfa7000a25bd84ddcd35813c99b4c       
    │       │       │   │ granularity  │ 1                                      
    │       │       │   │ tensor       │ &lt;class &#39;numpy.ndarray&#39;&gt; in shape (618, 
    │       │       │   │ mime_type    │ image/png                              
    │       │       │   │ uri          │ apple.png                              
    │       │       │   │ modality     │ image                                  
    │       │       │   ╰──────────────┴────────────────────────────────────────
    │       │       └── 📄 Document: 7769657ae7c25227920b5ae35a2a3c31
    │       │           ╭──────────────────────┬────────────────────────────────
    │       │           │ Attribute            │ Value                          
    │       │           ├──────────────────────┼────────────────────────────────
    │       │           │ parent_id            │ b6bcfa7000a25bd84ddcd35813c99b4
    │       │           │ granularity          │ 1                              
    │       │           │ text                 │ This is the image of an apple  
    │       │           │ modality             │ text                           
    │       │           ╰──────────────────────┴────────────────────────────────
    │       └── 📄 Document: 29f1835bac77e435f00976c5cf4e97cb
    │           ╭──────────────────────┬────────────────────────────────────────
    │           │ Attribute            │ Value                                  
    │           ├──────────────────────┼────────────────────────────────────────
    │           │ parent_id            │ 2a13aee3a2ac8eadc07f43bc2dd83583       
    │           │ granularity          │ 1                                      
    │           ╰──────────────────────┴────────────────────────────────────────
    │           └── 💠 Chunks
    │               └── 📄 Document: bc8adb52bad51ccff3d6e7834a4b536a
    │                   ╭──────────────────────┬────────────────────────────────
    │                   │ Attribute            │ Value                          
    │                   ├──────────────────────┼────────────────────────────────
    │                   │ parent_id            │ 29f1835bac77e435f00976c5cf4e97c
    │                   │ granularity          │ 1                              
    │                   │ text                 │ Second page                    
    │                   │ modality             │ text                           
    │                   ╰──────────────────────┴────────────────────────────────
    └── 📄 Document: c602af33ed3f2d693a5633e53b87e19c
        ╭─────────────────────┬─────────────────────────────────────────────────
        │ Attribute           │ Value                                           
        ├─────────────────────┼─────────────────────────────────────────────────
        │ parent_id           │ cab4e047bc84ffb6b8b0597ff4ee0e9f                
        │ granularity         │ 1                                               
        │ tags                │ {&#39;author&#39;: &#39;Jina AI&#39;, &#39;issue&#39;: &#39;1&#39;}             
        │ modality            │ json                                            
        ╰─────────────────────┴─────────────────────────────────────────────────
</pre></div>
</div>
</div>
</details></section>
</section>
<section id="access-the-data">
<h2>Access the data<a class="headerlink" href="#access-the-data" title="Permalink to this heading">#</a></h2>
<p>After instantiation, each modality can be accessed directly from the Document:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docarray.typing</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">Text</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Page</span><span class="p">:</span>
    <span class="n">main_text</span><span class="p">:</span> <span class="n">Text</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">Image</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Text</span>


<span class="n">page</span> <span class="o">=</span> <span class="n">Page</span><span class="p">(</span>
    <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;Hello world&#39;</span><span class="p">,</span>
    <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;This is the image of an apple&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">main_text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">main_text</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">tensor</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;Document (&#39;id&#39;, &#39;parent_id&#39;, &#39;granularity&#39;, &#39;text&#39;, &#39;modality&#39;) at 1ee83d2c391f078736732bb34a021587&gt;
Hello world
&lt;Document (&#39;id&#39;, &#39;parent_id&#39;, &#39;granularity&#39;, &#39;tensor&#39;, &#39;mime_type&#39;, &#39;uri&#39;, &#39;_metadata&#39;, &#39;modality&#39;) at c8fe3b8fd101bea6a4820a53d2993bdf&gt;
[[[255 255 255]
  [255 255 255]
  [255 255 255]
  ...
  [255 255 255]
  [255 255 255]
  [255 255 255]]]
</pre></div>
</div>
</section>
<section id="generate-embeddings">
<h2>Generate embeddings<a class="headerlink" href="#generate-embeddings" title="Permalink to this heading">#</a></h2>
<p>Common use cases, such as neural search, involve generating embeddings for your data.</p>
<p>There are two ways of doing this, each of which has its use cases:
Generating individually embeddings for each modality, and generating an overall embedding for the entire Document.</p>
<section id="embed-each-modality">
<h3>Embed each modality<a class="headerlink" href="#embed-each-modality" title="Permalink to this heading">#</a></h3>
<p>If you want to create an embedding for each modality of each page, you can simply access the corresponding Document, and add an embedding vector.</p>
<p>This can be useful, for example, when you want to compare different Documents based on a specific modality that they store.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="kn">import</span> <span class="n">resnet50</span>

<span class="n">img_model</span> <span class="o">=</span> <span class="n">resnet50</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># embed textual data</span>
<span class="n">doc</span><span class="o">.</span><span class="n">main_text</span><span class="o">.</span><span class="n">embed_feature_hashing</span><span class="p">()</span>
<span class="n">doc</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">embed_feature_hashing</span><span class="p">()</span>
<span class="c1"># embed image data</span>
<span class="n">doc</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">set_image_tensor_shape</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span><span class="o">.</span><span class="n">set_image_tensor_channel_axis</span><span class="p">(</span>
    <span class="n">original_channel_axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">new_channel_axis</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_image_tensor_normalization</span><span class="p">(</span><span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">img_model</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">main_text</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(256,)
(256,)
torch.Size([1000])
</pre></div>
</div>
<p>If you have a <a class="reference internal" href="../../api/docarray.array.document/#docarray.array.document.DocumentArray" title="docarray.array.document.DocumentArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">DocumentArray</span></code></a> of multi-modal Documents, you can embed the modalities of each
Document in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="n">Document</span>

<span class="n">da</span> <span class="o">=</span> <span class="n">DocumentArray</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Document</span><span class="p">(</span>
            <span class="n">Page</span><span class="p">(</span>
                <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;First page&#39;</span><span class="p">,</span>
                <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s1">&#39;This is the image of an apple&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">Document</span><span class="p">(</span>
            <span class="n">Page</span><span class="p">(</span>
                <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;Second page&#39;</span><span class="p">,</span>
                <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Still the same image of the same apple&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="kn">import</span> <span class="n">resnet50</span>

<span class="n">img_model</span> <span class="o">=</span> <span class="n">resnet50</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># embed textual data</span>
<span class="n">da</span><span class="p">[</span><span class="s1">&#39;@.[description, main_text]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">embed_feature_hashing</span><span class="p">())</span>
<span class="c1"># embed image data</span>
<span class="n">da</span><span class="p">[</span><span class="s1">&#39;@.[image]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">set_image_tensor_shape</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
    <span class="o">.</span><span class="n">set_image_tensor_channel_axis</span><span class="p">(</span><span class="n">original_channel_axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">new_channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_image_tensor_normalization</span><span class="p">(</span><span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">da</span><span class="p">[</span><span class="s1">&#39;@.[image]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">img_model</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;@.[description, main_text]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;@.[image]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(4, 256)
torch.Size([2, 1000])
</pre></div>
</div>
</section>
<section id="embed-parent-document">
<h3>Embed parent Document<a class="headerlink" href="#embed-parent-document" title="Permalink to this heading">#</a></h3>
<p>From the individual embeddings you can create a combined embedding for the entire Document.
This can be useful, for example, when you want to compare different Documents based on all the modalities that they store.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">combine_embeddings</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># any (more sophisticated) function could go here</span>
    <span class="n">d</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">embedding</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">main_text</span><span class="o">.</span><span class="n">embedding</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">embedding</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>


<span class="n">da</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">combine_embeddings</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(2, 1512)
</pre></div>
</div>
</section>
</section>
<section id="perform-search">
<span id="multimodal-search-example"></span><h2>Perform search<a class="headerlink" href="#perform-search" title="Permalink to this heading">#</a></h2>
<p>With the embeddings from above you can tackle downstream tasks, such as neural search.</p>
<section id="find-document-by-modality-embedding">
<h3>Find Document by modality embedding<a class="headerlink" href="#find-document-by-modality-embedding" title="Permalink to this heading">#</a></h3>
<p>Let’s assume you have multiple pages, and you want to find the page that contains a similar image as some other page
(the query page).</p>
<div class="seealso admonition">
<p class="admonition-title">Subindices</p>
<p>For this search task we use DocumentArray <a class="reference internal" href="../../fundamentals/documentarray/subindex/#subindex"><span class="std std-ref">subindices</span></a>.</p>
<p>This patterns is especially important when using a <a class="reference internal" href="../../advanced/document-store/#doc-store"><span class="std std-ref">Document store</span></a>, since it avoid loading Documents into memory.</p>
</div>
<p>First, create your dataset and query Document:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">docarray</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">Document</span><span class="p">,</span> <span class="n">DocumentArray</span>
<span class="kn">from</span> <span class="nn">docarray.typing</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">Text</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Page</span><span class="p">:</span>
    <span class="n">main_text</span><span class="p">:</span> <span class="n">Text</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">Image</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">Text</span>


<span class="n">query_page</span> <span class="o">=</span> <span class="n">Page</span><span class="p">(</span>
    <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;Hello world&#39;</span><span class="p">,</span>
    <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;This is the image of an apple&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">query_page</span><span class="p">)</span>  <span class="c1"># our query Document</span>

<span class="n">da</span> <span class="o">=</span> <span class="n">DocumentArray</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Document</span><span class="p">(</span>
            <span class="n">Page</span><span class="p">(</span>
                <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;First page&#39;</span><span class="p">,</span>
                <span class="n">image</span><span class="o">=</span><span class="s1">&#39;apple.png&#39;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s1">&#39;This is the image of an apple&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">Document</span><span class="p">(</span>
            <span class="n">Page</span><span class="p">(</span>
                <span class="n">main_text</span><span class="o">=</span><span class="s1">&#39;Second page&#39;</span><span class="p">,</span>
                <span class="n">image</span><span class="o">=</span><span class="s1">&#39;pear.png&#39;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s1">&#39;This is an image of a pear&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">subindex_configs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;@.[image]&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
<span class="p">)</span>  <span class="c1"># our dataset of pages</span>
</pre></div>
</div>
<p>Then you can embed your dataset and your query:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="kn">import</span> <span class="n">resnet50</span>

<span class="n">img_model</span> <span class="o">=</span> <span class="n">resnet50</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># embed query</span>
<span class="n">query</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">set_image_tensor_shape</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span><span class="o">.</span><span class="n">set_image_tensor_channel_axis</span><span class="p">(</span>
    <span class="n">original_channel_axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">new_channel_axis</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_image_tensor_normalization</span><span class="p">(</span><span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">img_model</span><span class="p">)</span>

<span class="c1"># embed dataset</span>
<span class="n">da</span><span class="p">[</span><span class="s1">&#39;@.[image]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">set_image_tensor_shape</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
    <span class="o">.</span><span class="n">set_image_tensor_channel_axis</span><span class="p">(</span><span class="n">original_channel_axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">new_channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_image_tensor_normalization</span><span class="p">(</span><span class="n">channel_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">img_model</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, cou can perform a search using <a class="reference internal" href="../../api/docarray.array.document/#docarray.array.document.DocumentArray.find" title="docarray.array.document.DocumentArray.find"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find()</span></code></a> to find the closest image,
and the parent Document that contains that image:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">closest_match_img</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;@.[image]&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CLOSEST IMAGE:&#39;</span><span class="p">)</span>
<span class="n">closest_match_img</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PAGE WITH THE CLOSEST IMAGE:&#39;</span><span class="p">)</span>
<span class="n">closest_match_page</span> <span class="o">=</span> <span class="n">da</span><span class="p">[</span><span class="n">closest_match_img</span><span class="o">.</span><span class="n">parent_id</span><span class="p">]</span>
<span class="n">closest_match_page</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Output<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>CLOSEST IMAGE:
📄 Document: 5922ee1ad0dbfe707301b573f98c5939
╭─────────────┬────────────────────────────────────────────────────────────────╮
│ Attribute   │ Value                                                          │
├─────────────┼────────────────────────────────────────────────────────────────┤
│ parent_id   │ e6266f88f6ebcb3417358440934bcf81                               │
│ granularity │ 1                                                              │
│ tensor      │ &lt;class &#39;numpy.ndarray&#39;&gt; in shape (3, 224, 224), dtype: float32 │
│ mime_type   │ image/png                                                      │
│ uri         │ apple.png                                                      │
│ embedding   │ &lt;class &#39;torch.Tensor&#39;&gt; in shape (1000,), dtype: float32        │
│ modality    │ image                                                          │
│ scores      │ defaultdict(&lt;class &#39;docarray.score.NamedScore&#39;&gt;, {&#39;cosine&#39;:    │
│             │ {&#39;value&#39;: -1.1920929e-07}})                                    │
╰─────────────┴────────────────────────────────────────────────────────────────╯
PAGE WITH THE CLOSEST IMAGE:
📄 Document: e6266f88f6ebcb3417358440934bcf81
└── 💠 Chunks
    ├── 📄 Document: 29a0e323e2e9befcc42e9823b111f90f
    │   ╭──────────────────────┬────────────────────────────────────────────────
    │   │ Attribute            │ Value                                          
    │   ├──────────────────────┼────────────────────────────────────────────────
    │   │ parent_id            │ e6266f88f6ebcb3417358440934bcf81               
    │   │ granularity          │ 1                                              
    │   │ text                 │ First page                                     
    │   │ modality             │ text                                           
    │   ╰──────────────────────┴────────────────────────────────────────────────
    ├── 📄 Document: 5922ee1ad0dbfe707301b573f98c5939
    │   ╭─────────────┬─────────────────────────────────────────────────────────
    │   │ Attribute   │ Value                                                   
    │   ├─────────────┼─────────────────────────────────────────────────────────
    │   │ parent_id   │ e6266f88f6ebcb3417358440934bcf81                        
    │   │ granularity │ 1                                                       
    │   │ tensor      │ &lt;class &#39;numpy.ndarray&#39;&gt; in shape (3, 224, 224), dtype: f
    │   │ mime_type   │ image/png                                               
    │   │ uri         │ apple.png                                               
    │   │ embedding   │ &lt;class &#39;torch.Tensor&#39;&gt; in shape (1000,), dtype: float32 
    │   │ modality    │ image                                                   
    │   ╰─────────────┴─────────────────────────────────────────────────────────
    └── 📄 Document: 175e386b1aa248f9387db46341b73e05
        ╭──────────────────────┬────────────────────────────────────────────────
        │ Attribute            │ Value                                          
        ├──────────────────────┼────────────────────────────────────────────────
        │ parent_id            │ e6266f88f6ebcb3417358440934bcf81               
        │ granularity          │ 1                                              
        │ text                 │ This is the image of an apple                  
        │ modality             │ text                                           
        ╰──────────────────────┴────────────────────────────────────────────────
</pre></div>
</div>
</div>
</details></section>
<section id="find-document-by-combined-embedding">
<h3>Find Document by combined embedding<a class="headerlink" href="#find-document-by-combined-embedding" title="Permalink to this heading">#</a></h3>
<p>Similarly, you might want to find the page that is <em>overall</em> most similar to the other pages in your dataset.</p>
<p>To do that, you first have to embed each modality for each Document, and then combine the embeddings to an overall embedding:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torchvision.models</span> <span class="kn">import</span> <span class="n">resnet50</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">img_model</span> <span class="o">=</span> <span class="n">resnet50</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># embed text data in query and dataset</span>
<span class="n">query</span><span class="o">.</span><span class="n">main_text</span><span class="o">.</span><span class="n">embed_feature_hashing</span><span class="p">()</span>
<span class="n">query</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">embed_feature_hashing</span><span class="p">()</span>
<span class="n">da</span><span class="p">[</span><span class="s1">&#39;@.[description, main_text]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">embed_feature_hashing</span><span class="p">())</span>

<span class="c1"># combine embeddings to overall embedding</span>
<span class="k">def</span> <span class="nf">combine_embeddings</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># any (more sophisticated) function could go here</span>
    <span class="n">d</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">embedding</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">main_text</span><span class="o">.</span><span class="n">embedding</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">embedding</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>


<span class="n">query</span> <span class="o">=</span> <span class="n">combine_embeddings</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>  <span class="c1"># combine embeddings for query</span>
<span class="n">da</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">combine_embeddings</span><span class="p">)</span>  <span class="c1"># combine embeddings in dataset</span>
</pre></div>
</div>
<p>Then, you can perform search directly on the top level:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">closest_match_page</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;OVERALL CLOSEST PAGE:&#39;</span><span class="p">)</span>
<span class="n">closest_match_page</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Output<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>OVERALL CLOSEST PAGE:
📄 Document: a0f33de91bb7d53811c7cb3015cdf1b8
╭───────────┬──────────────────────────────────────────────────────────────────╮
│ Attribute │ Value                                                            │
├───────────┼──────────────────────────────────────────────────────────────────┤
│ embedding │ &lt;class &#39;numpy.ndarray&#39;&gt; in shape (1512,), dtype: float64         │
│ scores    │ defaultdict(&lt;class &#39;docarray.score.NamedScore&#39;&gt;, {&#39;cosine&#39;:      │
│           │ {&#39;value&#39;: 0.01911603045476573}})                                 │
╰───────────┴──────────────────────────────────────────────────────────────────╯
└── 💠 Chunks
    ├── 📄 Document: b9c9206422e27c8a0f1b4a4e745901ec
    │   ╭─────────────┬─────────────────────────────────────────────────────────
    │   │ Attribute   │ Value                                                   
    │   ├─────────────┼─────────────────────────────────────────────────────────
    │   │ parent_id   │ a0f33de91bb7d53811c7cb3015cdf1b8                        
    │   │ granularity │ 1                                                       
    │   │ text        │ First page                                              
    │   │ embedding   │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
    │   │             │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
    │   │             │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
    │   │             │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
    │   │             │ ▄▄▄▄▄▄▄                                                 
    │   │ modality    │ text                                                    
    │   ╰─────────────┴─────────────────────────────────────────────────────────
    ├── 📄 Document: 97cbca49aeaf0ea1f609b161dc9ec934
    │   ╭─────────────┬─────────────────────────────────────────────────────────
    │   │ Attribute   │ Value                                                   
    │   ├─────────────┼─────────────────────────────────────────────────────────
    │   │ parent_id   │ a0f33de91bb7d53811c7cb3015cdf1b8                        
    │   │ granularity │ 1                                                       
    │   │ tensor      │ &lt;class &#39;numpy.ndarray&#39;&gt; in shape (3, 224, 224), dtype: f
    │   │ mime_type   │ image/png                                               
    │   │ uri         │ apple.png                                               
    │   │ embedding   │ &lt;class &#39;torch.Tensor&#39;&gt; in shape (1000,), dtype: float32 
    │   │ modality    │ image                                                   
    │   ╰─────────────┴─────────────────────────────────────────────────────────
    └── 📄 Document: 9183813fc38f291f353b76d4125506d6
        ╭─────────────┬─────────────────────────────────────────────────────────
        │ Attribute   │ Value                                                   
        ├─────────────┼─────────────────────────────────────────────────────────
        │ parent_id   │ a0f33de91bb7d53811c7cb3015cdf1b8                        
        │ granularity │ 1                                                       
        │ text        │ This is the image of an apple                           
        │ embedding   │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
        │             │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
        │             │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
        │             │ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
        │             │ ▄▄▄▄▄▄▄                                                 
        │ modality    │ text                                                    
        ╰─────────────┴─────────────────────────────────────────────────────────
</pre></div>
</div>
</div>
</details></section>
</section>
</section>

                </article>
            </div>
            <footer>
                
                <div class="related-pages">
                    <a class="next-page" href="../../fundamentals/document/">
                        <div class="page-info">
                            <div class="context">
                                <span>Next</span>
                            </div>
                            <div class="title">Document</div>
                        </div>
                        <svg>
                            <use href="#svg-arrow-right"></use>
                        </svg>
                    </a>
                    <a class="prev-page" href="../tabular/">
                        <svg>
                            <use href="#svg-arrow-right"></use>
                        </svg>
                        <div class="page-info">
                            <div class="context">
                                <span>Previous</span>
                            </div>
                            
                            <div class="title"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-table" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v3.585a.746.746 0 010 .83v8.085A1.75 1.75 0 0114.25 16H6.309a.748.748 0 01-1.118 0H1.75A1.75 1.75 0 010 14.25V6.165a.746.746 0 010-.83V1.75zM1.5 6.5v7.75c0 .138.112.25.25.25H5v-8H1.5zM5 5H1.5V1.75a.25.25 0 01.25-.25H5V5zm1.5 1.5v8h7.75a.25.25 0 00.25-.25V6.5h-8zm8-1.5h-8V1.5h7.75a.25.25 0 01.25.25V5z"></path></svg> Table</div>
                            
                        </div>
                    </a>
                </div>
                <div class="bottom-of-page">
                    <div class="left-details">
                        <div class="copyright">
                            Copyright &#169; Jina AI Limited. All rights reserved.
                        </div><div class="last-updated">
                            Last updated on Jan 17, 2023</div>
                    </div>
                    <div class="right-details">
                        <div class="social-btns">
                            <a class='social-btn' href="https://github.com/jina-ai/docarray/" aria-label="GitHub"
                               target="_blank" rel="noreferrer"> <i class="fab fa-github"></i></a>
                            <a class='social-btn' href="https://slack.jina.ai" aria-label="Slack" target="_blank"
                               rel="noreferrer"> <i class="fab fa-slack"></i></a>
                            <a class='social-btn' href="https://youtube.com/c/jina-ai" aria-label="YouTube"
                               target="_blank" rel="noreferrer"> <i class="fab fa-youtube"></i></a>
                            <a class='social-btn' href="https://twitter.com/JinaAI_" aria-label="Twitter"
                               target="_blank" rel="noreferrer"> <i class="fab fa-twitter"></i></a>
                            <a class='social-btn' href="https://www.linkedin.com/company/jinaai/" aria-label="LinkedIn"
                               target="_blank" rel="noreferrer"> <i class="fab fa-linkedin"></i></a>
                        </div>
                    </div>
                </div>
                
            </footer>
        </div>
        <aside class="toc-drawer">
            
            
            <div class="toc-sticky toc-scroll">
                <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
                </div>
                <div class="toc-tree-container">
                    <div class="toc-tree">
                        <ul>
<li><a class="reference internal" href="#"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-stack" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M7.122.392a1.75 1.75 0 011.756 0l5.003 2.902c.83.481.83 1.68 0 2.162L8.878 8.358a1.75 1.75 0 01-1.756 0L2.119 5.456a1.25 1.25 0 010-2.162L7.122.392zM8.125 1.69a.25.25 0 00-.25 0l-4.63 2.685 4.63 2.685a.25.25 0 00.25 0l4.63-2.685-4.63-2.685zM1.601 7.789a.75.75 0 011.025-.273l5.249 3.044a.25.25 0 00.25 0l5.249-3.044a.75.75 0 01.752 1.298l-5.248 3.044a1.75 1.75 0 01-1.756 0L1.874 8.814A.75.75 0 011.6 7.789zm0 3.5a.75.75 0 011.025-.273l5.249 3.044a.25.25 0 00.25 0l5.249-3.044a.75.75 0 01.752 1.298l-5.248 3.044a1.75 1.75 0 01-1.756 0l-5.248-3.044a.75.75 0 01-.273-1.025z"></path></svg> Multi-modal</a><ul>
<li><a class="reference internal" href="#model-your-data">Model your data</a><ul>
<li><a class="reference internal" href="#instantiate-a-document">Instantiate a Document</a></li>
<li><a class="reference internal" href="#nested-dataclasses-and-list-types">Nested dataclasses and list types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#access-the-data">Access the data</a></li>
<li><a class="reference internal" href="#generate-embeddings">Generate embeddings</a><ul>
<li><a class="reference internal" href="#embed-each-modality">Embed each modality</a></li>
<li><a class="reference internal" href="#embed-parent-document">Embed parent Document</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perform-search">Perform search</a><ul>
<li><a class="reference internal" href="#find-document-by-modality-embedding">Find Document by modality embedding</a></li>
<li><a class="reference internal" href="#find-document-by-combined-embedding">Find Document by combined embedding</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                    </div>
                </div>
            </div>
            
            
        </aside>
    </div>
    <qa-bot
            title="DocArray Bot"
            description="The data structure for unstructured data"
    >
        <template>
            <dl>
                <dt>You can ask questions about our docs. Try:</dt>
                <dd>What is a DocumentArray?</dd>
                <dd>How to use docarray with Jina?</dd>
                <dd>How to find nearest neighbour of Documents?</dd>
            </dl>
        </template>
    </qa-bot>
</div>
<img referrerpolicy="no-referrer-when-downgrade"
     src="https://static.scarf.sh/a.png?x-pxid=2823e771-0e1e-4320-8fde-48bc48e53262"/><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() { 
            document.querySelector('qa-bot').setAttribute('server', 'https://jina-ai-docarray.docsqa.jina.ai');
        });
        </script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qabot@0.4"></script>
    </body>
</html>